# ğŸš€ TrafikskolaX Local Development Setup

## Quick Start (3 minutes)

```bash
# 1. Quick setup with defaults
node scripts/quick-setup.js

# 2. Edit .env.local and add your DATABASE_URL
# (Get it from: https://console.neon.tech/app/projects)

# 3. Test and start
node scripts/test-database-connection.js
npm run dev
```

## ğŸ“‹ Setup Options

### Option 1: Quick Setup (Recommended for beginners)
```bash
node scripts/quick-setup.js
```
**What it does:**
- âœ… Creates `.env.local` with secure auto-generated secrets
- âœ… Sets development defaults
- âœ… Includes test values for optional services
- âŒ **You must manually add DATABASE_URL**

### Option 2: Interactive Setup (Recommended for full control)
```bash
node scripts/setup-environment.js
```
**What it does:**
- âœ… Interactive prompts for all settings
- âœ… Auto-generates secure secrets
- âœ… Tests database connection
- âœ… Guides you through the process

### Option 3: Manual Setup (Advanced users)
```bash
# Copy template and edit manually
cp ENV_LOCAL_TEMPLATE.txt .env.local
# Edit .env.local with your values
```

## ğŸ”§ Required vs Optional Settings

### REQUIRED (app won't start without these):
```env
DATABASE_URL="your_neon_database_url"
JWT_SECRET="secure_random_string_32_chars"
NEXT_PUBLIC_APP_URL="http://localhost:3000"
ENCRYPTION_KEY="32_character_string"
```

### OPTIONAL (app works with defaults):
```env
# Payment systems (use test values for development)
NEXT_PUBLIC_SWISH_NUMBER="1234567890"
QLIRO_MERCHANT_ID="test-merchant-id"
SENDGRID_API_KEY="test-sendgrid-key"
```

## ğŸ§ª Testing Your Setup

### Test Database Connection
```bash
node scripts/test-database-connection.js
```
**Expected output:**
```
ğŸ” Testing Database Connection
==============================
âœ… Basic connection successful!
âœ… Found 42 tables in database:
   1. bookings
   2. users
   ...
ğŸ‰ Database connection test completed successfully!
```

### Test Unified Teori System
```bash
node scripts/test-unified-teori-system.js
```
**Expected output:**
```
ğŸ§ª Testing Unified Teori System
==============================
âœ… Basic connection successful!
ğŸ“š lesson_types table: X active records
ğŸ“ teori_lesson_types table: Y active records
ğŸ‰ Unified Teori system test completed successfully!
```

### Test Table Removal Scripts
```bash
node scripts/verify-table-removal.js
```
**Shows which tables are safe to remove**

## ğŸ”‘ Getting Your DATABASE_URL

### Step 1: Go to Neon Console
1. Visit: https://console.neon.tech/app/projects
2. Select your project
3. Go to "Dashboard" â†’ "Connection Details"

### Step 2: Copy Connection String
```sql
-- Example Neon URL format:
postgresql://username:password@ep-xyz.us-east-1.neon.tech/dbname?sslmode=require

-- Copy this exact string to your .env.local:
DATABASE_URL="postgresql://username:password@ep-xyz.us-east-1.neon.tech/dbname?sslmode=require"
```

### Step 3: Verify Connection
```bash
node scripts/test-database-connection.js
```

## ğŸ” Generating Secure Secrets

### JWT Secret (32+ characters)
```bash
# Option 1: Auto-generated by setup scripts
node scripts/setup-environment.js

# Option 2: Manual generation
openssl rand -base64 32
```

### Encryption Keys (32 characters)
```bash
# Auto-generated by setup scripts
node scripts/quick-setup.js

# Manual generation
openssl rand -hex 32
```

## ğŸš¨ Troubleshooting

### Error: "DATABASE_URL is not set"
```bash
# Fix: Add DATABASE_URL to .env.local
DATABASE_URL="your_neon_connection_string"
```

### Error: "JWT_SECRET environment variable is required"
```bash
# Fix: Add JWT_SECRET to .env.local
JWT_SECRET="your_secure_jwt_secret"
```

### Error: "connect ECONNREFUSED"
```bash
# Possible fixes:
# 1. Check DATABASE_URL format
# 2. Verify Neon database is active
# 3. Check your internet connection
# 4. Ensure IP is allowed in Neon console
```

### Error: "authentication failed"
```bash
# Fix: Check your credentials in DATABASE_URL
# Verify username/password in Neon console
```

## ğŸ“ File Structure After Setup

```
your-project/
â”œâ”€â”€ .env.local                 # â† Your environment config
â”œâ”€â”€ ENV_LOCAL_TEMPLATE.txt     # â† Template for reference
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ quick-setup.js         # â† Quick setup script
â”‚   â”œâ”€â”€ setup-environment.js   # â† Interactive setup
â”‚   â”œâ”€â”€ test-database-connection.js  # â† Test connection
â”‚   â””â”€â”€ test-unified-teori-system.js # â† Test Teori system
â””â”€â”€ ...
```

## ğŸ¯ Next Steps After Setup

### 1. Test Everything Works
```bash
npm run dev                    # Start the application
# Visit: http://localhost:3000
```

### 2. Test Database Scripts
```bash
node scripts/test-unified-teori-system.js    # Test Teori system
node scripts/verify-table-removal.js         # Check table cleanup
```

### 3. For Production Deployment
```bash
# Use real API keys instead of test values
# Generate new secure secrets
# Set NODE_ENV="production"
# Use production database URL
```

## ğŸ“ Need Help?

### Quick Checklist:
- [ ] `.env.local` file exists in project root
- [ ] `DATABASE_URL` is set with Neon connection string
- [ ] `JWT_SECRET` is set with 32+ character string
- [ ] `NEXT_PUBLIC_APP_URL` is set to `http://localhost:3000`
- [ ] Database connection test passes

### Get Help:
1. **Run setup script**: `node scripts/setup-environment.js`
2. **Check template**: `ENV_LOCAL_TEMPLATE.txt`
3. **Test connection**: `node scripts/test-database-connection.js`
4. **Contact Neon support** for database issues

---

**ğŸ‰ Ready to develop!** Your local environment should now be fully configured for TrafikskolaX development with secure secrets and proper database connectivity.
